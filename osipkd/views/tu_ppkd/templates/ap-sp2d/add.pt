<html metal:use-macro="load: ../base.pt">
  <div metal:fill-slot="content">
    <script type='text/javascript'>
        $(document).ready(function () {
            $("#btn_close").click(function () {
                window.location = '/ap-sp2d';
                return false;
            });
        });
        $("#bud_nip").attr('readonly',true);
        $("#bud_nama").attr('readonly',true);
        $("#verified_nip").attr('readonly',true);
        $("#verified_nama").attr('readonly',true);
    </script>
  <div  class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">${request.title}</h3>
    </div>
    <div class="panel-body">
      <form method="post" accept-charset="utf-8" id="myform" class="form-horizontal" enctype="multipart/form-data">
        <div tal:condition="'id' in form" style="display:none;">
          <div tal:define="field form['id']">
              ${structure:field.serialize()}
          </div>
        </div>
        
        <!--Kode-------------------------------------------------------------------->
        <div class="form-group"> 
          <div tal:define="field form['kode']" id="item-${field.oid}">
            <label for="${field.oid}" class="control-label col-md-1" id="req-${field.oid}">
                    ${field.title}</label>
            <div class="col-md-2">
               ${structure:field.serialize()}
              <p id="error-${field.oid}" class="help-block" tal:condition="field.error"
                 tal:repeat="error field.error.messages()">
                 ${error}</p>
            </div>
          </div>
          <div tal:define="field form['tanggal']" id="item-${field.oid}">
            <label for="${field.oid}" class="control-label col-md-3" id="req-${field.oid}">
                    ${field.title}</label>
            <div class="col-md-2">
               ${structure:field.serialize()}
              <p id="error-${field.oid}" class="help-block" tal:condition="field.error"
                 tal:repeat="error field.error.messages()">
                 ${error}</p>
            </div>
          </div>
        </div>
        <div class="form-group"> 
          <div tal:define="field form['ap_spm_id']" style="display: none;">
              ${structure:field.serialize()}
          </div>
          <div tal:define="field form['spm_kd']"  id="item-${field.oid}">
            <label for="${field.oid}" class="control-label col-md-1" id="req-${field.oid}">
                    ${field.title}</label>
            <div class="col-md-2">
               ${structure:field.serialize()}
                <p id="error-${field.oid}" class="help-block" tal:condition="field.error"
                   tal:repeat="error field.error.messages()">
                   ${error}</p>
            </div>
          </div>

          <div class="col-md-5" tal:define="field form['spm_nm']" id="item-${field.oid}">
               ${structure:field.serialize()}
                <p id="error-${field.oid}" class="help-block" tal:condition="field.error"
                   tal:repeat="error field.error.messages()">
                   ${error}</p>
          </div>
          <script>
               $('#spm_kd').typeahead({
                    "hint"     : true,
                    "highlight": true,
                    "minLength": 1,
                    "remote"   : "/ap-spm/act/headofkode?term=%QUERY",
                  },
                  {
                  "name"      : 'spm_kd',
                  "displayKey": 'value',
                });
                $('#spm_nm').typeahead({
                    "hint"     : true,
                    "highlight": true,
                    "minLength": 1,
                    "remote"   : "/ap-spm/act/headofnama?term=%QUERY",
                  },
                  {
                    "name"      : 'spm_nm',
                    "displayKey": 'value',
                  });
                  
              $('#spm_kd').bind('typeahead:selected', function(obj, datum, name) {      
                    $('#ap_spm_id').val(datum.id);
                    $('#spm_nm').val(datum.nama);
                    //$('#spm_kd').val(datum.kode);
              });
              $('#spm_nm').bind('typeahead:selected', function(obj, datum, name) {      
                    $('#ap_spm_id').val(datum.id);
                    //$('#spm_nm').val(datum.nama);
                    $('#spm_kd').val(datum.kode);
              });
              $("#spm_nm").attr('readonly',true);
          </script>
        </div>
        <div class="form-group"> 
          <div tal:define="field form['nama']" id="item-${field.oid}">
            <label for="${field.oid}" class="control-label col-md-1" id="req-${field.oid}">
                    ${field.title}</label>
            <div class="col-md-7">
               ${structure:field.serialize()}
              <p id="error-${field.oid}" class="help-block" tal:condition="field.error"
                 tal:repeat="error field.error.messages()">
                 ${error}</p>
            </div>
          </div>
        </div>

        <div class="form-group"> 
          <div tal:define="field form['bud_uid']" id="item-${field.oid}">
            <label for="${field.oid}" class="control-label col-md-1" id="req-${field.oid}">
                    ${field.title}</label>
            <div class="col-md-1">
               ${structure:field.serialize()}
              <p id="error-${field.oid}" class="help-block" tal:condition="field.error"
                 tal:repeat="error field.error.messages()">
                 ${error}</p>
            </div>
          </div>
          <div tal:define="field form['bud_nip']" id="item-${field.oid}">
            <div class="col-md-2">
               ${structure:field.serialize()}
              <p id="error-${field.oid}" class="help-block" tal:condition="field.error"
                 tal:repeat="error field.error.messages()">
                 ${error}</p>
            </div>
          </div>
          <div tal:define="field form['bud_nama']" id="item-${field.oid}">
            <div class="col-md-4">
               ${structure:field.serialize()}
              <p id="error-${field.oid}" class="help-block" tal:condition="field.error"
                 tal:repeat="error field.error.messages()">
                 ${error}</p>
            </div>
          </div>
          <script>
           $('#bud_uid').typeahead({
              "hint"     : true,
              "highlight": true,
              "minLength": 1,
              "remote"   : "/pejabat/act/headofkode2?term=%QUERY",
            },
            {
            "name"      : 'bud_uid',
            "displayKey": 'value',
          });
          $('#bud_nip').typeahead({
              "hint"     : true,
              "highlight": true,
              "minLength": 1,
              "remote"   : "/pejabat/act/headofnip2?term=%QUERY",
            },
            {
              "name"      : 'bud_nip',
              "displayKey": 'value',
            });
          $('#bud_nama').typeahead({
              "hint"     : true,
              "highlight": true,
              "minLength": 1,
              "remote"   : "/pejabat/act/headofnama2?term=%QUERY",
            },
            {
              "name"      : 'bud_nama',
              "displayKey": 'value',
            });
        
        $('#bud_uid').bind('typeahead:selected', function(obj, datum, name) {  
              $('#bud_nama').val(datum.nama);
              $('#bud_nip').val(datum.nip);
              $('#pejabat_id').val(datum.id);
        });
        $('#bud_nama').bind('typeahead:selected', function(obj, datum, name) {  
              $('#bud_uid').val(datum.kode);
              $('#bud_nip').val(datum.nip);
              $('#pejabat_id').val(datum.id);
        });
        $('#bud_nip').bind('typeahead:selected', function(obj, datum, name) {  
              $('#bud_nama').val(datum.nama);
              $('#bud_uid').val(datum.kode);
              $('#pejabat_id').val(datum.id);
        });
        $("#bud_uid").attr('readonly',true);
        $("#bud_nip").attr('readonly',true);
        </script>
        </div>
        <div class="form-group"> 
          <div tal:define="field form['verified_uid']" id="item-${field.oid}">
            <label for="${field.oid}" class="control-label col-md-1" id="req-${field.oid}">
                    ${field.title}</label>
            <div class="col-md-1">
               ${structure:field.serialize()}
              <p id="error-${field.oid}" class="help-block" tal:condition="field.error"
                 tal:repeat="error field.error.messages()">
                 ${error}</p>
            </div>
          </div>
          <div tal:define="field form['verified_nip']" id="item-${field.oid}">
            <div class="col-md-2">
               ${structure:field.serialize()}
              <p id="error-${field.oid}" class="help-block" tal:condition="field.error"
                 tal:repeat="error field.error.messages()">
                 ${error}</p>
            </div>
          </div>
          <div tal:define="field form['verified_nama']" id="item-${field.oid}">
            <div class="col-md-4">
               ${structure:field.serialize()}
              <p id="error-${field.oid}" class="help-block" tal:condition="field.error"
                 tal:repeat="error field.error.messages()">
                 ${error}</p>
            </div>
          </div>
        <script>
           $('#verified_uid').typeahead({
              "hint"     : true,
              "highlight": true,
              "minLength": 1,
              "remote"   : "/pejabat/act/headofkode3?term=%QUERY",
            },
            {
            "name"      : 'verified_uid',
            "displayKey": 'value',
          });
          $('#verified_nip').typeahead({
              "hint"     : true,
              "highlight": true,
              "minLength": 1,
              "remote"   : "/pejabat/act/headofnip3?term=%QUERY",
            },
            {
              "name"      : 'verified_nip',
              "displayKey": 'value',
            });
          $('#verified_nama').typeahead({
              "hint"     : true,
              "highlight": true,
              "minLength": 1,
              "remote"   : "/pejabat/act/headofnama3?term=%QUERY",
            },
            {
              "name"      : 'verified_nama',
              "displayKey": 'value',
            });
        
        $('#verified_uid').bind('typeahead:selected', function(obj, datum, name) {  
              $('#verified_nama').val(datum.nama);
              $('#verified_nip').val(datum.nip);
              $('#pejabat_id').val(datum.id);
        });
        $('#verified_nama').bind('typeahead:selected', function(obj, datum, name) {  
              $('#verified_uid').val(datum.kode);
              $('#verified_nip').val(datum.nip);
              $('#pejabat_id').val(datum.id);
        });
        $('#verified_nip').bind('typeahead:selected', function(obj, datum, name) {  
              $('#verified_nama').val(datum.nama);
              $('#verified_uid').val(datum.kode);
              $('#pejabat_id').val(datum.id);
        });
        $("#verified_uid").attr('readonly',true);
        $("#verified_nip").attr('readonly',true);
        </script>
        </div>

        <div class="form-group"> 
          <div class="col-md-4"> 
            <button type="submit" class="btn btn-primary" id="simpan" name="simpan" >Simpan</button>
            <button type="submit" class="btn btn-danger" id="batal" name="batal">Batal</button>
            <button type="submit" class="btn btn-warning" id="tutup" name="tutup">Tutup</button>
          </div>
        </div>               
      </form>
    </div>   
   </div> 
  </div>
</html>